!function(n){"use strict";function f(n){return n.split('"').length-1}window.SheetClip={parse:function(n){var t,e,r,l,g,i,p,s=[],u=0;for(1<(r=n.split("\n")).length&&""===r[r.length-1]&&r.pop(),t=0,e=r.length;t<e;t+=1){for(r[t]=r[t].split("\t"),l=0,g=r[t].length;l<g;l+=1)s[u]||(s[u]=[]),i&&0===l?(p=s[u].length-1,s[u][p]=s[u][p]+"\n"+r[t][0],i&&1&f(r[t][0])&&(i=!1,s[u][p]=s[u][p].substring(0,s[u][p].length-1).replace(/""/g,'"'))):l===g-1&&0===r[t][l].indexOf('"')&&1&f(r[t][l])?(s[u].push(r[t][l].substring(1).replace(/""/g,'"')),i=!0):(s[u].push(r[t][l].replace(/""/g,'"')),i=!1);i||(u+=1)}return s},stringify:function(n){var t,e,r,l,g,i="";for(t=0,e=n.length;t<e;t+=1){for(r=0,l=n[t].length;r<l;r+=1)0<r&&(i+="\t"),"string"==typeof(g=n[t][r])?-1<g.indexOf("\n")?i+='"'+g.replace(/"/g,'""')+'"':i+=g:i+=null==g?"":g;i+="\n"}return i}}}();